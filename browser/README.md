this is really anti-DRY and terrible, all written rather quickly and dirty.. will probably rewrite at some point, generalizing the code..
